# Disallow script execution in uploads

# Default: block everything in this directory (Apache 2.4 and 2.2)
<IfModule mod_authz_core.c>
  Require all denied
</IfModule>
<IfModule !mod_authz_core.c>
  Deny from all
</IfModule>

# Allow common image files
<FilesMatch "\.(?:jpe?g|png|gif|webp|bmp|svg)$">
  <IfModule mod_authz_core.c>
    Require all granted
  </IfModule>
  <IfModule !mod_authz_core.c>
    Order Allow,Deny
    Allow from all
  </IfModule>
</FilesMatch>

# Explicitly block script-like files
<FilesMatch "\.(?:php|phar|phtml|pl|py|jsp|asp|aspx|sh|cgi)$">
  <IfModule mod_authz_core.c>
    Require all denied
  </IfModule>
  <IfModule !mod_authz_core.c>
    Deny from all
  </IfModule>
</FilesMatch>
